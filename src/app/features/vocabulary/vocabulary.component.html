<div class="vocabulary-container">
  <h1>Dictionnaire</h1>

  <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º -->
  <div class="add-item-container">
    <button (click)="setWordType('word')">–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ</button>
    <button (click)="setWordType('expression')">–î–æ–±–∞–≤–∏—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ</button>
  </div>

  <!-- –ü–æ–ª—è –≤–≤–æ–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ -->
  <div *ngIf="showInputFields" class="input-fields">
    <input [(ngModel)]="newWord" placeholder="–í–≤–µ–¥–∏—Ç–µ {{ newWordType === 'word' ? '—Å–ª–æ–≤–æ' : '–≤—ã—Ä–∞–∂–µ–Ω–∏–µ' }}" />
    <input [(ngModel)]="newTranslation" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" />
    <button (click)="addItem()">–î–æ–±–∞–≤–∏—Ç—å</button>
  </div>

  <!-- –ë–ª–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
  <div class="sort-options">
    <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</label>
    <select [(ngModel)]="sortBy" (change)="sortWords()">
      <option value="date">–î–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</option>
      <option value="hardest">–°–ª–æ–∂–Ω–æ—Å—Ç–∏</option>
      <option value="repeat">–°–Ω–∞—á–∞–ª–∞ —Å–ª–æ–≤–∞ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</option>
      <option value="learned">–û—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∫–∞–∫ –∑–Ω–∞—é</option>
    </select>
  </div>

  <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ -->
  <div class="cards-container">
    <!-- –ö–æ–ª–æ–Ω–∫–∞ –¥–ª—è —Å–ª–æ–≤ -->
    <div class="column">
      <h3>–ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–ª–æ–≤–∞ ({{ words.length }})</h3>
      <div *ngFor="let card of paginatedWords" class="card-wrapper">
        <div class="card">
          <div class="card-inner" [class.flipped]="card.flipped">
            <div class="card-front">
              <div class="card-header">
                <p class="date-label">
                  üìÖ {{ card.createdAt | date:'dd/MM/yyyy' }}
                </p>
                <button class="delete-btn" (click)="deleteItem(card.id, 'word'); $event.stopPropagation()">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
              <div class="card-body">
                <p>{{ card.word }}</p>
                <span *ngIf="card.hintVisible" class="hint">–ö–ª–∏–∫–Ω–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–µ—Ä–µ–≤–æ–¥</span>
              </div>
              <button class="flip-btn" (click)="flipCard(card); $event.stopPropagation()">
                <i class="fas fa-retweet"></i> <!-- –∏–ª–∏ –¥—Ä—É–≥–∞—è –∏–∫–æ–Ω–∫–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä fa-rotate -->
              </button>
            </div>
            <div class="card-back">
              <div class="btn-group" *ngIf="!card.isCorrect && !card.showTranslation">
                <button *ngIf="!card.showTranslation && (card.hintIndex ?? 0) < card.translation.length - 1"
                  (click)="revealNextHint(card)">
                  {{ card.hintIndex ? '–ï—â—ë –ø–æ–¥—Å–∫–∞–∑–∫—É' : '–ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É' }}
                </button>

                <button *ngIf="!card.showTranslation" (click)="showFullTranslation(card)">
                  –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª–æ–≤–æ
                </button>
                <input [(ngModel)]="card.userInput" (keyup.enter)="checkTranslation(card)" placeholder="–í–≤–µ–¥–∏ –ø–µ—Ä–µ–≤–æ–¥"
                  class="input-field" />
              </div>

              <div *ngIf="(card.isCorrect === true || card.showTranslation) && !card.status" class="after-guess-btns">
                <button (click)="markAsLearned(card)">–Ø –∑–Ω–∞—é —ç—Ç–æ —Å–ª–æ–≤–æ</button>
                <button (click)="markForRepetition(card)">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ</button>
              </div>
              <div *ngIf="card.status === 'learned'" class="after-guess-btns">
                <button (click)="resetToPractice(card)">–°–Ω–æ–≤–∞ —Å–ø—Ä—è—Ç–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>
              </div>


              <p *ngIf="card.showTranslation || (card.hintIndex ?? 0) > 0" class="hint-display">
                {{ card.showTranslation ? card.translation : getHint(card) }}
              </p>


              <span *ngIf="card.isCorrect === true" class="correct">‚úîÔ∏è</span>
              <span *ngIf="card.isCorrect === false" class="wrong">‚ùå</span>

              <button class="flip-btn" (click)="flipCard(card); $event.stopPropagation()">
                <i class="fas fa-retweet"></i>
              </button>
            </div>


          </div>
        </div>
      </div>
      <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è —Å–ª–æ–≤ -->
      <div class="pagination">
        <button (click)="changeWordsPage(-1)">‚Üê</button>
        <span>–°—Ç—Ä. {{ currentWordsPage }}</span>
        <button (click)="changeWordsPage(1)">‚Üí</button>
      </div>
    </div>

    <!-- –ö–æ–ª–æ–Ω–∫–∞ –¥–ª—è –≤—ã—Ä–∞–∂–µ–Ω–∏–π -->
    <div class="column">
      <h3>–ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è ({{ expressions.length }})</h3>
      <div *ngFor="let card of paginatedExpressions" class="card-wrapper">
        <div class="card">
          <div class="card-inner" [class.flipped]="card.flipped">
            <div class="card-front">
              <div class="card-header">
                <p class="date-label">
                  üìÖ {{ card.createdAt | date:'dd/MM/yyyy' }}
                </p>
                <button class="delete-btn" (click)="deleteItem(card.id, 'expression'); $event.stopPropagation()">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
              <div class="card-body">
                <p>{{ card.word }}</p>
                <span *ngIf="card.hintVisible" class="hint">–ö–ª–∏–∫–Ω–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–µ—Ä–µ–≤–æ–¥</span>
              </div>
              <button class="flip-btn" (click)="flipCard(card); $event.stopPropagation()">
                <i class="fas fa-retweet"></i>
              </button>
            </div>
            <div class="card-back">
              <div class="btn-group" *ngIf="!card.isCorrect && !card.showTranslation">
                <button *ngIf="!card.showTranslation && (card.hintIndex ?? 0) < card.translation.length - 1"
                  (click)="revealNextHint(card)">
                  {{ card.hintIndex ? '–ï—â—ë –ø–æ–¥—Å–∫–∞–∑–∫—É' : '–ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É' }}
                </button>

                <button *ngIf="!card.showTranslation" (click)="showFullTranslation(card)">
                  –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª–æ–≤–æ
                </button>
                <input [(ngModel)]="card.userInput" (keyup.enter)="checkTranslation(card)" placeholder="–í–≤–µ–¥–∏ –ø–µ—Ä–µ–≤–æ–¥"
                  class="input-field" />
              </div>

              <div *ngIf="(card.isCorrect === true || card.showTranslation) && !card.status" class="after-guess-btns">
                <button (click)="markAsLearned(card)">–Ø –∑–Ω–∞—é —ç—Ç–æ —Å–ª–æ–≤–æ</button>
                <button (click)="markForRepetition(card)">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ</button>
              </div>

              <p *ngIf="card.showTranslation || (card.hintIndex ?? 0) > 0" class="hint-display">
                {{ card.showTranslation ? card.translation : getHint(card) }}
              </p>


              <span *ngIf="card.isCorrect === true" class="correct">‚úîÔ∏è</span>
              <span *ngIf="card.isCorrect === false" class="wrong">‚ùå</span>

              <button class="flip-btn" (click)="flipCard(card); $event.stopPropagation()">
                <i class="fas fa-retweet"></i>
              </button>
            </div>


          </div>
        </div>

      </div>
      <div class="pagination">
        <button (click)="changeExpressionsPage(-1)">‚Üê</button>
        <span>–°—Ç—Ä. {{ currentExpressionsPage }}</span>
        <button (click)="changeExpressionsPage(1)">‚Üí</button>
      </div>

    </div>
  </div>

</div>
