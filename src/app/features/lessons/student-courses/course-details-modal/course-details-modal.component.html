<div class="course-details-modal">
  <div class="modal-header">
    <h2 mat-dialog-title>
      <mat-icon class="course-icon">cast_for_education</mat-icon>
      {{ course.title }}
    </h2>
    <button mat-icon-button (click)="close()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <mat-dialog-content>
    <div class="course-info">
      <div *ngIf="course.level" class="info-item">
        <strong>üìä Niveau:</strong> {{ course.level }}
      </div>
      <div *ngIf="course.description" class="info-item">
        <strong>üìù Description:</strong> {{ course.description }}
      </div>
      <div class="info-item">
        <strong>üìÖ Cr√©√© le:</strong> {{ course.createdAt | date:'dd/MM/yyyy' }}
      </div>
    </div>

    <!-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–∞ -->
    <div class="course-structure" *ngIf="course.sections && course.sections.length > 0">
      <h3>üìö Structure du cours</h3>
      
      <div class="structure-tree">
        <div *ngFor="let section of course.sections" class="structure-section">
          <!-- –°–µ–∫—Ü–∏—è -->
          <div class="section-header" (click)="toggleSection(section)">
            <span class="expand-icon">
              {{ isSectionExpanded(section) ? 'ÀÑ' : 'ÀÖ' }}
            </span>
            <mat-icon class="section-icon">folder</mat-icon>
            <span class="section-name">{{ section }}</span>
            <span class="lessons-count" *ngIf="getLessonsInSection(section).length > 0">
              ({{ getLessonsInSection(section).length }} le√ßon{{ getLessonsInSection(section).length > 1 ? 's' : '' }})
            </span>
          </div>

          <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Å–µ–∫—Ü–∏–∏ (—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π) -->
          <div *ngIf="isSectionExpanded(section)" class="section-content">
            <!-- –£—Ä–æ–∫–∏ –≤ —Å–µ–∫—Ü–∏–∏ -->
            <div *ngIf="getLessonsInSection(section).length > 0" class="lessons-in-section">
              <div *ngFor="let lesson of getLessonsInSection(section)" class="lesson-item">
                <mat-icon class="lesson-type-icon" [class.lesson-self]="lesson.type === 'self'" [class.lesson-call]="lesson.type === 'call'">
                  {{ lesson.type === 'self' ? 'menu_book' : 'video_call' }}
                </mat-icon>
                <span class="lesson-name">{{ lesson.name }}</span>
                <span class="lesson-type-badge" [class.type-self]="lesson.type === 'self'" [class.type-call]="lesson.type === 'call'">
                  {{ lesson.type === 'self' ? 'Autonome' : 'Avec appel' }}
                </span>
                <span *ngIf="lesson.description" class="lesson-description">{{ lesson.description }}</span>
              </div>
            </div>

            <!-- –ü–æ–¥—Å–µ–∫—Ü–∏–∏ -->
            <div *ngIf="getSubSectionsForSection(section).length > 0" class="subsections-container">
              <div *ngFor="let subSection of getSubSectionsForSection(section)" class="subsection-item">
                <div class="subsection-header" (click)="toggleSubSection(section, subSection)">
                  <span class="expand-icon">
                    {{ isSubSectionExpanded(section, subSection) ? 'ÀÑ' : 'ÀÖ' }}
                  </span>
                  <mat-icon class="subsection-icon">folder_open</mat-icon>
                  <span class="subsection-name">{{ subSection }}</span>
                  <span class="lessons-count" *ngIf="getLessonsInSubSection(section, subSection).length > 0">
                    ({{ getLessonsInSubSection(section, subSection).length }} le√ßon{{ getLessonsInSubSection(section, subSection).length > 1 ? 's' : '' }})
                  </span>
                </div>

                <!-- –£—Ä–æ–∫–∏ –≤ –ø–æ–¥—Å–µ–∫—Ü–∏–∏ -->
                <div *ngIf="isSubSectionExpanded(section, subSection) && getLessonsInSubSection(section, subSection).length > 0" 
                     class="lessons-in-subsection">
                  <div *ngFor="let lesson of getLessonsInSubSection(section, subSection)" class="lesson-item">
                    <mat-icon class="lesson-type-icon" [class.lesson-self]="lesson.type === 'self'" [class.lesson-call]="lesson.type === 'call'">
                      {{ lesson.type === 'self' ? 'menu_book' : 'video_call' }}
                    </mat-icon>
                    <span class="lesson-name">{{ lesson.name }}</span>
                    <span class="lesson-type-badge" [class.type-self]="lesson.type === 'self'" [class.type-call]="lesson.type === 'call'">
                      {{ lesson.type === 'self' ? 'Autonome' : 'Avec appel' }}
                    </span>
                    <span *ngIf="lesson.description" class="lesson-description">{{ lesson.description }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—É—Å—Ç–∞—è -->
    <div *ngIf="!course.sections || course.sections.length === 0" class="no-structure">
      <mat-icon>info</mat-icon>
      <p>Ce cours n'a pas encore de structure d√©finie.</p>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="close()">Fermer</button>
  </mat-dialog-actions>
</div>


