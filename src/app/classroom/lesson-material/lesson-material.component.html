<div class="container mt-4" [ngStyle]="{ 'backgroundImage': backgroundStyle, 'backgroundSize': 'cover' }">

  <!-- ğŸ”§ Ğ‘Ğ¾ĞºĞ¾Ğ²Ñ‹Ğµ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸ -->
  <div class="side-tabs">
    <div class="tab-button left-tab" (click)="toggleBoard()" [class.active]="showBoard && !showGabarit"
      title="Afficher le tableau">
      ğŸ§‘â€ğŸ«
      <div class="label">Tableau interactif</div>
    </div>

    <div class="tab-button right-tab" (click)="toggleGabarit()" [class.active]="showGabarit"
      title="Afficher les matÃ©riaux">
      ğŸ“‚
      <div class="label">matÃ©riaux</div>
    </div>

    <!-- ğŸ‘¥ Nouvelle Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ° Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ»Ğ°ÑÑĞ¾Ğ¼ -->
    <div class="tab-button top-tab" (click)="toggleClassManagement()" [class.active]="showClassManagement"
      title="Gestion de classe">
      ğŸ‘¥
      <div class="label">Gestion de classe</div>
    </div>
  </div>

  <div class="row justify-content-center align-items-start video-wrapper position-relative">

    <!-- ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ²Ğ¸Ğ´ĞµĞ¾+Ğ´Ğ¾ÑĞºĞ° Ğ±Ğ»Ğ¾Ğº -->
    <div class="col-md-10 d-flex justify-content-center position-relative">

      <!-- ğŸ“‹ Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ´Ğ¾ÑĞºĞ° -->
      <app-interactive-board *ngIf="showBoard" class="whiteboard-layer position-absolute top-0 start-0 w-100 h-100">
      </app-interactive-board>

      <!-- ğŸ¥ Ğ’Ğ¸Ğ´ĞµĞ¾ -->
      <!-- <app-video-call *ngIf="videoService.showVideoCall$ | async" [isFloatingMode]="true" class="floating-video-layer">
      </app-video-call> -->

      <!-- ğŸ“ Gabarit -->
      <app-gabarit-page *ngIf="showGabarit" 
                        [lesson]="currentLesson" 
                        [readonly]="true"
                        [lessonStarted]="lessonStarted"
                        (openNotesEvent)="onGabaritOpenNotes($event)">

      </app-gabarit-page>

      <!-- ğŸ‘¥ ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ»Ğ°ÑÑĞ¾Ğ¼ -->
      <div *ngIf="showClassManagement" class="class-management-panel">
        <div class="class-header">
          <h2>ğŸ“ Gestion de classe DELF/DALF</h2>
          <button *ngIf="!currentClass" 
                  mat-raised-button 
                  color="primary" 
                  (click)="openCreateClassDialog()">
            â• CrÃ©er une nouvelle classe
          </button>
        </div>

        <!-- Ğ•ÑĞ»Ğ¸ ĞºĞ»Ğ°ÑÑ Ğ½Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½ -->
        <div *ngIf="!currentClass" class="no-class-message">
          <mat-card class="welcome-card">
            <mat-card-header>
              <mat-card-title>Bienvenue dans votre espace classe !</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <p>CrÃ©ez votre premiÃ¨re classe pour commencer Ã  enseigner le franÃ§ais (DELF/DALF)</p>
              <ul>
                <li>âœ… Organisez vos Ã©lÃ¨ves par niveau</li>
                <li>âœ… GÃ©rez les invitations d'Ã©lÃ¨ves</li>
                <li>âœ… Lancez des cours en ligne</li>
                <li>âœ… Suivez les progrÃ¨s de chaque Ã©lÃ¨ve</li>
              </ul>
            </mat-card-content>
          </mat-card>
        </div>

        <!-- Ğ•ÑĞ»Ğ¸ ĞºĞ»Ğ°ÑÑ ÑĞ¾Ğ·Ğ´Ğ°Ğ½ -->
        <div *ngIf="currentClass" class="class-details">
          <mat-card class="class-info-card">
            <mat-card-header>
              <div mat-card-avatar class="class-avatar">{{ currentClass.level }}</div>
              <mat-card-title>{{ currentClass.name }}</mat-card-title>
              <mat-card-subtitle>
                Niveau {{ currentClass.level }} â€¢ {{ currentClass.students?.length || 0 }}/{{ currentClass.maxStudents }} Ã©lÃ¨ves
              </mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <p>{{ currentClass.description }}</p>
              
              <!-- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² ĞºĞ»Ğ°ÑÑĞµ -->
              <div class="students-section">
                <h4>ğŸ“š Ã‰lÃ¨ves inscrits:</h4>
                <div *ngIf="currentClass.students?.length > 0; else noStudents" class="students-grid">
                  <mat-chip-set>
                    <mat-chip *ngFor="let student of currentClass.students" 
                             [removable]="true"
                             (removed)="removeStudentFromClass(student)">
                      {{ student.name }}
                      <mat-icon matChipRemove>cancel</mat-icon>
                    </mat-chip>
                  </mat-chip-set>
                </div>
                <ng-template #noStudents>
                  <p class="text-muted">Aucun Ã©lÃ¨ve inscrit pour le moment</p>
                </ng-template>
              </div>

              <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ -->
              <div class="class-actions">
                <button mat-raised-button color="primary" (click)="startVideoCall()">
                  ğŸ¥ Commencer le cours
                </button>
                <button mat-stroked-button (click)="openInviteStudentsDialog()">
                  â• Ajouter des Ã©lÃ¨ves
                </button>
                <button mat-stroked-button (click)="editClass()">
                  âœï¸ Modifier la classe
                </button>
                <button mat-stroked-button color="warn" (click)="deleteClass()">
                  ğŸ—‘ï¸ Supprimer la classe
                </button>
              </div>

              <!-- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ -->
              <div *ngIf="showStudentsList" class="students-selection-panel">
                <div class="students-selection-header">
                  <h4>ğŸ‘¥ Ajouter des Ã©lÃ¨ves confirmÃ©s</h4>
                  <button mat-icon-button (click)="closeStudentsList()">
                    <mat-icon>close</mat-icon>
                  </button>
                </div>
                
                <div *ngIf="availableStudents.length === 0" class="no-students-message">
                  <p>Aucun Ã©lÃ¨ve disponible pour l'ajout.</p>
                  <p>Les Ã©lÃ¨ves doivent d'abord Ãªtre confirmÃ©s dans l'onglet "Ã‰tudiants".</p>
                </div>
                
                <div *ngIf="availableStudents.length > 0" class="available-students-list">
                  <mat-card *ngFor="let student of availableStudents" class="student-selection-card">
                    <mat-card-content>
                      <div class="student-selection-info">
                        <h5>{{ student.name }}</h5>
                        <p *ngIf="student.nextLessonDate">
                          Prochain cours: {{ student.nextLessonDate | date:'dd/MM/yyyy HH:mm' }}
                        </p>
                      </div>
                      <button mat-raised-button 
                              color="primary" 
                              (click)="addStudentToCurrentClass(student)">
                        <mat-icon>person_add</mat-icon>
                        Ajouter Ã  la classe
                      </button>
                    </mat-card-content>
                  </mat-card>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>

    </div>

    <!-- ğŸ§© ĞĞ¸Ğ¶Ğ½ÑÑ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹ -->
    <div class="fixed-task-panel bg-light px-4 py-2" [class.collapsed]="tasksCollapsed">
      <div class="collapse-toggle" (click)="toggleTasksCollapsed()">
        {{ tasksCollapsed ? 'ğŸ”¼' : 'ğŸ”½' }}
      </div>

      <!-- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ -->
      <div *ngIf="isLoadingData" class="loading-container text-center py-3">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2">Chargement des donnÃ©es du cours...</p>
      </div>

      <div *ngIf="!tasksCollapsed && !isLoadingData" class="d-flex justify-content-between">
        
        <!-- ğŸ‘¨â€ğŸ“ Ã‰tudiant -->
        <div class="student-zone w-50 pe-2">
          <h5 class="zone-header">ğŸ‘¨â€ğŸ“ Ã‰tudiant</h5>

          <!-- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¸ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ¼ -->
          <div *ngIf="userRole === 'student' || userRole === 'teacher'" class="input-group mb-2">
            <input type="text" [(ngModel)]="newStudentTask" placeholder="Ajouter une tÃ¢che" class="form-control"
              (keyup.enter)="addStudentTask()" />
            <button class="btn btn-outline-primary" (click)="addStudentTask()">â•</button>
          </div>

          <div *ngIf="userRole === 'student' || userRole === 'teacher'" class="input-group mb-2">
            <input type="text" [(ngModel)]="newStudentQuestion" placeholder="Ajouter une question" class="form-control"
              (keyup.enter)="addStudentQuestion()" />
            <button class="btn btn-outline-info" (click)="addStudentQuestion()">â•</button>
          </div>

          <!-- ğŸ’¼ Bloc devoirs -->
          <div *ngIf="userRole === 'student' || userRole === 'teacher'" class="input-group mb-2">
          </div>

          <!-- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ°Ğ´Ğ°Ñ‡ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ° -->
          <div class="section-header">ğŸ“ TÃ¢ches</div>
          <div *ngFor="let task of currentLesson?.studentTasks" (mouseenter)="onHover(task, $event)"
            (mouseleave)="onLeaveItem()" class="position-relative">

            <div class="task-card student-task" [class.covered-in-class]="isCoveredInClass(task)">
              <label class="task-label d-flex align-items-center">
                <span class="task-text">{{ task.title }}</span>
                <div class="status-indicators ms-auto">
                  <span *ngIf="isAddedToHomework(task)" class="badge bg-success ms-1" title="AjoutÃ© aux devoirs">ğŸ“‹</span>
                  <span *ngIf="isCoveredInClass(task)" class="badge bg-info ms-1" title="TraitÃ© en classe">âœ…</span>
                  <button *ngIf="lessonStarted && !isResolved(task)" 
                          class="btn btn-sm btn-outline-success ms-1" 
                          (click)="markTaskAsCompleted(task.id)"
                          title="Marquer comme terminÃ©">
                    âœ…
                  </button>
                </div>
              </label>

              <!-- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸ -->
              <div *ngIf="hoveredItem === task" class="item-actions" [ngClass]="{
                'drop-above': hoveredPosition === 'above',
                'drop-below': hoveredPosition === 'below'
              }" (mouseenter)="onEnterActions()" (mouseleave)="onLeaveActions()">
                <div class="action-item primary" (click)="lessonStarted && openNotes('tasks', task, task)" [class.disabled]="!lessonStarted" [attr.tabindex]="lessonStarted ? 0 : -1" [attr.aria-disabled]="!lessonStarted">
                  ğŸ“ Travailler la tÃ¢che
                </div>
                <!-- <div class="action-item secondary" (click)="lessonStarted && addToHomework('task', task, task)" [class.disabled]="!lessonStarted" [attr.tabindex]="lessonStarted ? 0 : -1" [attr.aria-disabled]="!lessonStarted">
                  ğŸ“‹ Ajouter aux devoirs
                </div> -->
                <!-- Ğ—Ğ°ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ -->
                <!--
                <div class="action-item" (click)="postpone(task)">â­ Revoir au prochain cours</div>
                <div class="action-item" (click)="goToMindmap(task)">ğŸ§  Mindmap</div>
                <div class="action-item" (click)="goToDictionary(task)">ğŸ“˜ Dictionnaire</div>
                -->
              </div>
            </div>
          </div>

          <!-- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ° -->
          <div class="section-header">â“ Questions</div>
          <div *ngFor="let question of currentLesson?.studentQuestions" (mouseenter)="onHover(question, $event)"
            (mouseleave)="onLeaveItem()" class="position-relative">

            <div class="question-card student-question" [class.covered-in-class]="isCoveredInClass(question)">
              <label class="question-label d-flex align-items-center">
                <span class="question-text">{{ question.question }}</span>
                <div class="status-indicators ms-auto">
                  <span *ngIf="isAddedToHomework(question)" class="badge bg-success ms-1" title="AjoutÃ© aux devoirs">ğŸ“‹</span>
                  <span *ngIf="isCoveredInClass(question)" class="badge bg-info ms-1" title="TraitÃ© en classe">âœ…</span>
                  <button *ngIf="lessonStarted && !isResolved(question)" 
                          class="btn btn-sm btn-outline-success ms-1" 
                          (click)="markQuestionAsCompleted(question.id)"
                          title="Marquer comme terminÃ©">
                    âœ…
                  </button>
                </div>
              </label>

              <!-- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸ -->
              <div *ngIf="hoveredItem === question" class="item-actions" [ngClass]="{
                'drop-above': hoveredPosition === 'above',
                'drop-below': hoveredPosition === 'below'
              }" (mouseenter)="onEnterActions()" (mouseleave)="onLeaveActions()">
                <div class="action-item primary" (click)="lessonStarted && openNotes('questions', question, question)" [class.disabled]="!lessonStarted" [attr.tabindex]="lessonStarted ? 0 : -1" [attr.aria-disabled]="!lessonStarted">
                  â“ Travailler la question
                </div>
                <!-- <div class="action-item secondary" (click)="lessonStarted && addToHomework('question', question, question)" [class.disabled]="!lessonStarted" [attr.tabindex]="lessonStarted ? 0 : -1" [attr.aria-disabled]="!lessonStarted">
                  ğŸ“‹ Ajouter aux devoirs
                </div> -->
                <!-- Ğ—Ğ°ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ -->
                <!--
                <div class="action-item" (click)="postponeQuestion(question)">â­ Revoir au prochain cours</div>
                <div class="action-item" (click)="goToMindmap(question)">ğŸ§  Mindmap</div>
                <div class="action-item" (click)="goToDictionary(question)">ğŸ“˜ Dictionnaire</div>
                -->
              </div>
            </div>
          </div>



          <!-- Ğ”Ğ¾Ğ¼Ğ°ÑˆĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ -->
          <div *ngIf="homeworkItems?.length || currentLesson?.homework?.length" class="section-header">ğŸ“š Devoirs</div>
          
          <!-- Ğ”Ğ¾Ğ¼Ğ°ÑˆĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ· ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ (Ğ½Ğ¾Ğ²Ñ‹Ğµ) -->
          <div *ngIf="homeworkItems?.length" class="homework-list">
            <div *ngFor="let homework of homeworkItems" class="homework-item-card">
              <div class="homework-header">
                <span class="homework-title">{{ homework.title }}</span>
              </div>
              <div *ngIf="homework.description" class="homework-description">{{ homework.description }}</div>
              <div class="homework-meta">
                <span class="homework-type">{{ homework.type === 'task' ? 'TÃ¢che' : homework.type === 'question' ? 'Question' : 'MatÃ©riau' }}</span>
                <span class="homework-due">Ã‰chÃ©ance: {{ homework.dueDate | date:'dd/MM/yyyy' }}</span>
              </div>
              <div class="homework-actions">
                <button *ngIf="lessonStarted && homework.status !== 'finished' && !homework.isCompleted" 
                        class="btn btn-sm btn-success" 
                        (click)="markHomeworkAsCompleted(homework.id)">
                  âœ… Marquer comme terminÃ©
                </button>
                <span *ngIf="lessonStarted && homework.status === 'finished' || homework.isCompleted" 
                      class="completed-badge">
                  âœ… TerminÃ©
                </span>
              </div>
            </div>
          </div>
          
          <!-- Ğ”Ğ¾Ğ¼Ğ°ÑˆĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ ÑÑ‚Ğ°Ñ€Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ (Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸) -->
          <div *ngIf="currentLesson?.homework?.length" class="homework-list legacy">
            <div *ngFor="let hw of currentLesson.homework" class="homework-item">{{ hw }}</div>
          </div>
        </div>

        <!-- ğŸ‘©â€ğŸ« Enseignant -->
        <div class="teacher-zone w-50 ps-2">
          <h5 class="zone-header">ğŸ‘©â€ğŸ« Enseignant</h5>

          <!-- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼ -->
          <div *ngIf="userRole === 'teacher'" class="input-group mb-2">
            <input type="text" [(ngModel)]="newTeacherTask" placeholder="Ajouter une tÃ¢che pour moi"
              class="form-control" (keyup.enter)="addTeacherTask()" />
            <button class="btn btn-outline-warning" (click)="addTeacherTask()">â•</button>
          </div>

          <!-- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼ -->
          <div *ngIf="userRole === 'teacher'" class="input-group mb-2">
            <input type="text" [(ngModel)]="newTeacherQuestion" placeholder="Ajouter une question pour moi"
              class="form-control" (keyup.enter)="addTeacherQuestion()" />
            <button class="btn btn-outline-info" (click)="addTeacherQuestion()">â•</button>
          </div>

          <!-- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»Ñ -->
          <div class="section-header">ğŸ“ TÃ¢ches</div>
          <div *ngFor="let task of currentLesson?.teacherTasks" (mouseenter)="onHover(task, $event)"
            (mouseleave)="onLeaveItem()" class="position-relative">

            <div class="task-card teacher-task" [class.covered-in-class]="isCoveredInClass(task)">
              <label class="task-label d-flex align-items-center">
                <span class="task-text">{{ task.title }}</span>
                <div class="status-indicators ms-auto">
                  <span *ngIf="isAddedToHomework(task)" class="badge bg-success ms-1" title="AjoutÃ© aux devoirs">ğŸ“‹</span>
                  <span *ngIf="isCoveredInClass(task)" class="badge bg-info ms-1" title="TraitÃ© en classe">âœ…</span>
                  <button *ngIf="lessonStarted && !isResolved(task) && userRole === 'teacher'" 
                          class="btn btn-sm btn-outline-success ms-1" 
                          (click)="markTaskAsCompleted(task.id)"
                          title="Marquer comme terminÃ©">
                    âœ…
                  </button>
                </div>
              </label>

              <!-- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸ -->
              <div *ngIf="hoveredItem === task && userRole === 'teacher'" class="item-actions" [ngClass]="{
                'drop-above': hoveredPosition === 'above',
                'drop-below': hoveredPosition === 'below'
              }" (mouseenter)="onEnterActions()" (mouseleave)="onLeaveActions()">
                <div class="action-item primary" (click)="lessonStarted && openNotes('tasks', task, task)" [class.disabled]="!lessonStarted" [attr.tabindex]="lessonStarted ? 0 : -1" [attr.aria-disabled]="!lessonStarted">
                  ğŸ“ Travailler la tÃ¢che
                </div>
                <!-- Ğ—Ğ°ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ -->
                <!--
                <div class="action-item" (click)="postpone(task)">â­ Revoir au prochain cours</div>
                <div class="action-item" (click)="goToMindmap(task)">ğŸ§  Mindmap</div>
                <div class="action-item" (click)="goToDictionary(task)">ğŸ“˜ Dictionnaire</div>
                -->
              </div>
            </div>
          </div>

          <!-- Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»Ñ -->
          <div class="section-header">â“ Questions</div>
          <div *ngFor="let question of currentLesson?.teacherQuestions" (mouseenter)="onHover(question, $event)"
            (mouseleave)="onLeaveItem()" class="position-relative">

            <div class="question-card teacher-question" [class.covered-in-class]="isCoveredInClass(question)">
              <label class="question-label d-flex align-items-center">
                <span class="question-text">{{ question.question }}</span>
                <div class="status-indicators ms-auto">
                  <span *ngIf="isAddedToHomework(question)" class="badge bg-success ms-1" title="AjoutÃ© aux devoirs">ğŸ“‹</span>
                  <span *ngIf="isCoveredInClass(question)" class="badge bg-info ms-1" title="TraitÃ© en classe">âœ…</span>
                  <span *ngIf="isResolved(question.id)">âœ…</span>
                </div>
              </label>

              <!-- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸ -->
              <div *ngIf="hoveredItem === question && userRole === 'teacher'" class="item-actions" [ngClass]="{
                'drop-above': hoveredPosition === 'above',
                'drop-below': hoveredPosition === 'below'
              }" (mouseenter)="onEnterActions()" (mouseleave)="onLeaveActions()">
                <div class="action-item primary" (click)="lessonStarted && openNotes('questions', question, question)" [class.disabled]="!lessonStarted" [attr.tabindex]="lessonStarted ? 0 : -1" [attr.aria-disabled]="!lessonStarted">
                  â“ Travailler la question
                </div>
                <!-- Ğ—Ğ°ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ -->
                <!--
                <div class="action-item" (click)="postponeQuestion(question)">â­ Revoir au prochain cours</div>
                <div class="action-item" (click)="goToMindmap(question)">ğŸ§  Mindmap</div>
                <div class="action-item" (click)="goToDictionary(question)">ğŸ“˜ Dictionnaire</div>
                -->
              </div>
            </div>
          </div>



        </div>
      </div>
    </div>

  </div>

  <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ° ÑÑ‚Ğ°Ñ€Ñ‚Ğ° ÑƒÑ€Ğ¾ĞºĞ° -->
  <div class="text-center my-3">
    <button *ngIf="!lessonStarted" (click)="startLesson()" class="btn btn-success btn-lg">
      â–¶ï¸ DÃ©marrer la session
    </button>
    <div *ngIf="lessonStarted" class="lesson-timer alert alert-info mt-2">
      â³ Temps restant: {{ countdown }} sec
    </div>
  </div>
</div>
